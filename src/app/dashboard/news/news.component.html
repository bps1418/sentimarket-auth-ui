<div class="filters">
    <input placeholder="Filter by ticker" [(ngModel)]="filterTicker" (ngModelChange)="applyFilters()" />
  
    <select [(ngModel)]="filterCategory" (ngModelChange)="applyFilters()">
      <option value="">All Categories</option>
      <option *ngFor="let cat of categoryOptions" [value]="cat">{{ cat }}</option>
    </select>
  
    <select [(ngModel)]="filterSource" (ngModelChange)="applyFilters()">
      <option value="">All Sources</option>
      <option *ngFor="let src of sourceOptions" [value]="src">{{ src }}</option>
    </select>
  
    <label>Min Impact Score:</label>
    <input type="number" [(ngModel)]="filterImpactScore" (ngModelChange)="applyFilters()" min="0" step="0.1" />
  
    <label>From:</label>
    <input type="date" [(ngModel)]="filterStartDate" (ngModelChange)="applyFilters()" />
  
    <label>To:</label>
    <input type="date" [(ngModel)]="filterEndDate" (ngModelChange)="applyFilters()" />
  </div>
  
  <!-- Stats Display -->
  <div class="stats">
    <p><strong>Total News:</strong> {{ totalNews }}</p>
    <p><strong>Average Impact Score:</strong> {{ averageImpactScore | number: '1.2-2' }}</p>
    <p><strong>Impact Score Std Dev:</strong> {{ impactScoreStdDev | number: '1.2-2' }}</p>
  </div>
  
  <table *ngIf="paginatedNews.length">
    <thead>
      <tr>
        <th (click)="changeSort('headline')">Headline</th>
        <th (click)="changeSort('ticker')">Ticker</th>
        <th (click)="changeSort('category')">Category</th>
        <th>Sentiment (GPT)</th>
        <th>FinBERT</th>
        <th>Mistral</th>
        <th (click)="changeSort('impactScore')">Impact</th>
        <th (click)="changeSort('source')">Source</th>
        <th (click)="changeSort('datetime')">Date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of paginatedNews">
        <td><a [href]="item.url" target="_blank">{{ item.headline }}</a></td>
        <td>{{ item.ticker }}</td>
        <td>{{ item.category || 'N/A' }}</td>
        <td>{{ item.sentimentGpt }}</td>
        <td>{{ item.sentimentFinbert }}</td>
        <td>{{ item.sentimentMistral }}</td>
        <td>{{ item.impactScore !== null ? item.impactScore : 'N/A' }}</td>
        <td>{{ item.source }}</td>
        <td>{{ item.datetime | date: 'short' }}</td>
      </tr>
    </tbody>
  </table>
  
  <!-- Pagination -->
  <div class="pagination" *ngIf="filteredNews.length > pageSize">
    <button (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
    <span>Page {{ currentPage }} of {{ totalPages }}</span>
    <button (click)="changePage(currentPage + 1)" [disabled]="currentPage >= filteredNews.length / pageSize">Next</button>
  </div>